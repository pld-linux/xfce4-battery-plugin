diff -ur xfce4-battery-plugin-1.0.0-orig/configure.ac xfce4-battery-plugin-1.0.0/configure.ac
--- xfce4-battery-plugin-1.0.0-orig/configure.ac	2011-01-03 14:54:16.000000000 +0100
+++ xfce4-battery-plugin-1.0.0/configure.ac	2011-03-01 12:05:31.976989137 +0100
@@ -67,7 +67,7 @@
 XDT_CHECK_PACKAGE([GTK], [gtk+-2.0], [2.6.0])
 XDT_CHECK_PACKAGE([GTHREAD], [gthread-2.0], [2.6.0])
 XDT_CHECK_PACKAGE([LIBXFCE4UTIL], [libxfce4util-1.0], [4.3.90.2])
-XDT_CHECK_PACKAGE([LIBXFCEGUI4], [libxfcegui4-1.0], [4.3.90.2])
+XDT_CHECK_PACKAGE([LIBXFCE4UI], [libxfce4ui-1], [4.8.0])
 XDT_CHECK_PACKAGE([LIBXFCE4PANEL], [libxfce4panel-1.0], [4.3.90.2])
 
 dnl ***********************************
diff -ur xfce4-battery-plugin-1.0.0-orig/panel-plugin/battery.c xfce4-battery-plugin-1.0.0/panel-plugin/battery.c
--- xfce4-battery-plugin-1.0.0-orig/panel-plugin/battery.c	2011-01-03 13:38:40.000000000 +0100
+++ xfce4-battery-plugin-1.0.0/panel-plugin/battery.c	2011-03-01 12:08:11.823872637 +0100
@@ -47,10 +47,10 @@
 #include <stdlib.h>
 
 #include <libxfce4util/libxfce4util.h>
-#include <libxfcegui4/libxfcegui4.h>
+#include <libxfce4ui/libxfce4ui.h>
 
 #include <gtk/gtk.h>
-#include <libxfce4panel/xfce-panel-plugin.h>
+#include <libxfce4panel/libxfce4panel.h>
 
 #include "libacpi.h"
 
@@ -588,7 +588,7 @@
                 int interm=(battmon->options.action_on_critical == BM_COMMAND_TERM)?1:0;
                 if (!battmon->options.command_on_critical ||
                     !strlen(battmon->options.command_on_critical)) goto do_critical_warn;
-                xfce_exec (battmon->options.command_on_critical, interm, 0, NULL);
+                xfce_spawn_command_line_on_screen(gdk_screen_get_default(), battmon->options.command_on_critical, interm, 0, NULL);
             }
         } else if (!battmon->low){
                 battmon->low = TRUE;
@@ -606,7 +606,7 @@
                 int interm=(battmon->options.action_on_low == BM_COMMAND_TERM)?1:0;
                 if (!battmon->options.command_on_low ||
                     !strlen(battmon->options.command_on_low)) goto do_low_warn;
-                xfce_exec(battmon->options.command_on_low, interm, 0, NULL);
+                xfce_spawn_command_line_on_screen(gdk_screen_get_default(), battmon->options.command_on_low, interm, 0, NULL);
             }
         }
     }
diff -ur xfce4-battery-plugin-1.0.0-orig/panel-plugin/Makefile.am xfce4-battery-plugin-1.0.0/panel-plugin/Makefile.am
--- xfce4-battery-plugin-1.0.0-orig/panel-plugin/Makefile.am	2011-01-03 13:38:40.000000000 +0100
+++ xfce4-battery-plugin-1.0.0/panel-plugin/Makefile.am	2011-03-01 12:05:31.980991141 +0100
@@ -22,14 +22,14 @@
 
 xfce4_battery_plugin_CFLAGS =						\
 	$(LIBXFCE4PANEL_CFLAGS)						\
-	$(LIBXFCEGUI4_CFLAGS)						\
+	$(LIBXFCE4UI_CFLAGS)						\
 	$(LIBXFCE4UTIL_CFLAGS)						\
 	$(GTK_CFLAGS)							\
 	$(PLATFORM_CFLAGS)
 
 xfce4_battery_plugin_LDADD =						\
 	$(LIBXFCE4PANEL_LIBS)						\
-	$(LIBXFCEGUI4_LIBS)						\
+	$(LIBXFCE4UI_LIBS)						\
 	$(LIBXFCE4UTIL_LIBS)						\
 	$(GTK_LIBS)
 
